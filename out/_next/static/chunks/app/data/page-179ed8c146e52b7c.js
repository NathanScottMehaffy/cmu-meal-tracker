(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[315],{4717:function(e,t,l){Promise.resolve().then(l.bind(l,370))},370:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return i}});var a=l(7437),n=l(2265),r=l(7138),s=l(5151);function i(){let{darkMode:e,toggleDarkMode:t,mealPlans:l,addMealPlanData:i,clearAllData:o,getCurrentMealOption:d}=(0,s.q)(),[c,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)("idle"),h=d(),[p,v]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{v(!0)},[]),(0,a.jsxs)("div",{className:"min-h-screen ".concat(e?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:[(0,a.jsxs)("nav",{className:"bg-red-800 p-4 text-white flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(r.default,{href:"/",className:"mr-4",children:"Dashboard"}),(0,a.jsx)(r.default,{href:"/data",className:"mr-4 font-bold",children:"Data"})]}),(0,a.jsx)("button",{onClick:t,className:"px-3 py-1 rounded ".concat(e?"bg-gray-100 text-gray-900":"bg-gray-900 text-white"),children:e?"Light Mode":"Dark Mode"})]}),(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6 ".concat(e?"text-white":"text-gray-900"),children:"Data Management"}),p&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Upload HTML Files"}),(0,a.jsx)("input",{type:"file",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(l){let e=new FileReader;e.onload=e=>{try{var t;let l=null===(t=e.target)||void 0===t?void 0:t.result,a=function(e){var t,l;let a=new DOMParser().parseFromString(e,"text/html"),n=Array.from(a.querySelectorAll("#tbl-plans tr:not(.header-row)")).map(e=>{var t,l,a,n,r,s,i,o,d;return{startDate:null!==(i=null===(l=e.querySelector(".column0"))||void 0===l?void 0:null===(t=l.textContent)||void 0===t?void 0:t.trim())&&void 0!==i?i:"",planName:null!==(o=null===(n=e.querySelector(".column1"))||void 0===n?void 0:null===(a=n.textContent)||void 0===a?void 0:a.trim())&&void 0!==o?o:"",currentBalance:null!==(d=null===(s=e.querySelector(".column2"))||void 0===s?void 0:null===(r=s.textContent)||void 0===r?void 0:r.trim())&&void 0!==d?d:"",transactions:[]}}),r=Array.from(a.querySelectorAll("#tbl-trx tr:not(.header-row)")).map(e=>{var t,l,a,n,r,s,i,o,d,c,u,m;return{location:null!==(d=null===(l=e.querySelector("th"))||void 0===l?void 0:null===(t=l.textContent)||void 0===t?void 0:t.trim())&&void 0!==d?d:"",dateTime:null!==(c=null===(n=e.querySelector("td:nth-child(2)"))||void 0===n?void 0:null===(a=n.textContent)||void 0===a?void 0:a.trim())&&void 0!==c?c:"",requestedAmount:null!==(u=null===(s=e.querySelector("td:nth-child(3)"))||void 0===s?void 0:null===(r=s.textContent)||void 0===r?void 0:r.trim())&&void 0!==u?u:"",approvedAmount:null!==(m=null===(o=e.querySelector("td:nth-child(4)"))||void 0===o?void 0:null===(i=o.textContent)||void 0===i?void 0:i.trim())&&void 0!==m?m:""}}),s=a.querySelector("#select-plan option[selected]"),i=null!==(l=null==s?void 0:null===(t=s.textContent)||void 0===t?void 0:t.trim())&&void 0!==l?l:"",o=n.find(e=>e.planName===i);return o&&(o.transactions=r),n}(l);0===a.length?x("noData"):(i(a),x("success"))}catch(e){console.error("Error parsing file:",e),x("error")}},e.readAsText(l)}},accept:".html",className:"mb-4"}),"success"===m&&(0,a.jsx)("p",{className:"text-green-500 mt-2",children:"File parsed successfully!"}),"error"===m&&(0,a.jsx)("p",{className:"text-red-500 mt-2",children:"Error parsing file. Please try again."}),"noData"===m&&(0,a.jsx)("p",{className:"text-yellow-500 mt-2",children:"No data found in the file."})]}),(0,a.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Export Data"}),(0,a.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify({mealPlans:l},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="meal_plan_data.json",a.click()},className:"bg-red-800 text-white px-4 py-2 rounded mr-4",children:"Export Data"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 mt-6 ".concat(e?"text-white":"text-gray-900"),children:"Import Data"}),(0,a.jsx)("input",{type:"file",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(l){let e=new FileReader;e.onload=e=>{var t;i(JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result).mealPlans)},e.readAsText(l)}},accept:".json",className:"mb-4"})]}),(0,a.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow md:col-span-2"),children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Current Data"}),h&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Current Meal Option"}),(0,a.jsx)("p",{children:h})]}),l.length>0?(0,a.jsxs)("div",{children:[l.map((e,t)=>(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-2",children:["Meal Plan: ",e.planName," (Start Date: ",e.startDate,")"]}),(0,a.jsxs)("p",{children:["Current Balance: ",e.currentBalance]}),(0,a.jsx)("h4",{className:"text-md font-semibold mt-4 mb-2",children:"Transactions"}),e.transactions.length>0?(0,a.jsxs)("table",{className:"w-full mb-4",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left",children:"Location"}),(0,a.jsx)("th",{className:"text-left",children:"Date/Time"}),(0,a.jsx)("th",{className:"text-left",children:"Requested Amount"}),(0,a.jsx)("th",{className:"text-left",children:"Approved Amount"})]})}),(0,a.jsx)("tbody",{children:e.transactions.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.location}),(0,a.jsx)("td",{children:e.dateTime}),(0,a.jsx)("td",{children:e.requestedAmount}),(0,a.jsx)("td",{children:e.approvedAmount})]},t))})]}):(0,a.jsx)("p",{children:"No transactions available"})]},t)),(0,a.jsx)("button",{onClick:()=>u(!0),className:"bg-red-800 text-white px-4 py-2 rounded mt-4",children:"Clear All Data"})]}):(0,a.jsx)("p",{children:"No data available"})]})]})]}),c&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg"),children:[(0,a.jsx)("p",{className:"mb-4",children:"Are you sure you want to clear all data?"}),(0,a.jsx)("button",{onClick:()=>{o(),u(!1)},className:"bg-red-800 text-white px-4 py-2 rounded mr-2",children:"Yes, Clear Data"}),(0,a.jsx)("button",{onClick:()=>u(!1),className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Cancel"})]})})]})}},5151:function(e,t,l){"use strict";l.d(t,{q:function(){return r}});var a=l(9099),n=l(9291);let r=(0,a.Ue)()((0,n.tJ)((e,t)=>({darkMode:!1,mealPlans:[],currentMealOption:null,toggleDarkMode:()=>e(e=>({darkMode:!e.darkMode})),addMealPlanData:t=>e(e=>{let l=[...e.mealPlans],a=null;return t.forEach(e=>{let t=l.findIndex(t=>t.startDate===e.startDate&&t.planName===e.planName);if(-1!==t){let a=l[t];l[t]={...a,currentBalance:e.currentBalance,transactions:[...a.transactions,...e.transactions].filter((e,t,l)=>t===l.findIndex(t=>t.dateTime===e.dateTime&&t.location===e.location&&t.approvedAmount===e.approvedAmount))}}else l.push(e);e.planName.includes("Green")?a="Green":e.planName.includes("Blue")?a="Blue":e.planName.includes("Red")&&(a="Red")}),{mealPlans:l,currentMealOption:a||e.currentMealOption}}),clearAllData:()=>e({mealPlans:[],currentMealOption:null}),getCurrentMealOption:()=>t().currentMealOption}),{name:"cmu-meal-tracker-storage"}))}},function(e){e.O(0,[465,971,23,744],function(){return e(e.s=4717)}),_N_E=e.O()}]);