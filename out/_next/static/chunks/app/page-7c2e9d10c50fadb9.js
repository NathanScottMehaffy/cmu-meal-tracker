(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8752:function(e,a,t){Promise.resolve().then(t.bind(t,6774))},6774:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(7437),s=t(2265),n=t(7138),r=t(5151),d=t(7346),i=t(5211);i.kL.register(i.uw,i.f$,i.od,i.jn,i.Dx,i.u,i.De);let o={Green:{blocks:286,flexDollars:270},Blue:{blocks:246,flexDollars:520},Red:{blocks:199,flexDollars:850}};function c(){let{darkMode:e,toggleDarkMode:a,getCurrentMealOption:t}=(0,r.q)(),[i,c]=(0,s.useState)(0),[x,h]=(0,s.useState)(0),[u,m]=(0,s.useState)(0),[g,p]=(0,s.useState)(0),[b,f]=(0,s.useState)(0),[j,w]=(0,s.useState)(0),[y,N]=(0,s.useState)(0),[D,k]=(0,s.useState)(0),[M,F]=(0,s.useState)(""),[v,S]=(0,s.useState)(""),[A,O]=(0,s.useState)(0),[T,B]=(0,s.useState)(0),P=t(),[C,U]=(0,s.useState)(!1);(0,s.useEffect)(()=>{U(!0);let{mealPlans:e}=r.q.getState(),a=[{name:"Orientation to Fall Break",start:new Date(2024,7,25),end:new Date(2024,9,11)},{name:"After Fall Break to Thanksgiving",start:new Date(2024,9,21),end:new Date(2024,10,26)},{name:"After Thanksgiving to Winter Break",start:new Date(2024,11,2),end:new Date(2024,11,15)}],t=a.reduce((e,a)=>e+Math.floor((a.end.getTime()-a.start.getTime())/864e5)+1,0);h(t);let l=new Date,s=0,n=!1;for(let e of a){if(l>=e.start&&l<=e.end){s+=Math.floor((l.getTime()-e.start.getTime())/864e5)+1,n=!0;break}l>e.end&&(s+=Math.floor((e.end.getTime()-e.start.getTime())/864e5)+1)}if(c(n?s:t),P){let a=o[P].blocks,l=o[P].flexDollars,n=e.find(e=>e.planName.includes(P)&&!e.planName.includes("Flex")&&!e.planName.includes("Guest")),r=e.find(e=>e.planName.includes(P)&&e.planName.includes("Flex"));if(n){let e=a-n.transactions.length;m(e),N((a-e)/s),f(a/t);let l=a-(t-s)/t*a,r=a-e;F("".concat(r<l?"Ahead":"Behind"," by ").concat(Math.abs(r-l).toFixed(1)," blocks")),O(e/(t-s))}if(r){let e=parseFloat(r.currentBalance.split("$")[1]);p(e),k((l-e)/s),w(l/t);let a=l-(t-s)/t*l,n=l-e;S("".concat(n<a?"Ahead":"Behind"," by $").concat(Math.abs(n-a).toFixed(2))),B(e/(t-s))}}},[P]);let $=(e,a,t,l)=>{let s=Array.from({length:l+1},(a,t)=>e-e/l*t),n=r.q.getState().mealPlans.find(e=>(a?!e.planName.includes("Flex"):e.planName.includes("Flex"))&&e.planName.includes(P||"")),d=n?a?Array.from({length:t+1},(a,l)=>{let s=n.transactions.filter(e=>new Date(e.dateTime)<=new Date(new Date().setDate(new Date().getDate()-(t-l))));return{x:l,y:e-s.length}}):n.transactions.reduce((a,t,l)=>{let s=parseFloat(t.approvedAmount.replace("$",""));return a.push({x:l,y:a.length>0?a[a.length-1].y-s:e-s}),a},[]):[];return{labels:Array.from({length:l+1},(e,a)=>a.toString()),datasets:[{label:"Actual Usage",data:d,borderColor:"red",fill:!1,pointRadius:0},{label:"Ideal Usage",data:s.map((e,a)=>({x:a,y:e})),borderColor:"blue",fill:!1,pointRadius:0,order:1}]}},_=P?$(o[P].blocks,!0,i,x):{labels:[],datasets:[]},E=P?$(o[P].flexDollars,!1,i,x):{labels:[],datasets:[]},R={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Usage Over Time"}},scales:{x:{type:"linear"}}};return(0,l.jsxs)("div",{className:"min-h-screen ".concat(e?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:[(0,l.jsxs)("nav",{className:"bg-red-800 p-4 text-white flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(n.default,{href:"/",className:"mr-4 font-bold",children:"Dashboard"}),(0,l.jsx)(n.default,{href:"/data",className:"mr-4",children:"Data"})]}),(0,l.jsx)("button",{onClick:a,className:"px-3 py-1 rounded ".concat(e?"bg-gray-100 text-gray-900":"bg-gray-900 text-white"),children:e?"Light Mode":"Dark Mode"})]}),(0,l.jsxs)("div",{className:"container mx-auto p-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6 ".concat(e?"text-white":"text-gray-900"),children:"Meal Plan Dashboard"}),C&&P?(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Meal Plan Overview"}),(0,l.jsxs)("p",{children:["Current Meal Option: ",P]}),(0,l.jsxs)("p",{children:["Total days on campus: ",x]}),(0,l.jsxs)("p",{children:["Current day: ",i]}),(0,l.jsxs)("p",{children:["Meal blocks remaining: ",u]}),(0,l.jsxs)("p",{children:["Flex dollars remaining: $",g.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Current Status"}),(0,l.jsxs)("p",{children:["Meal blocks:"," ",(0,l.jsx)("span",{style:{color:M.includes("Ahead")?"green":"red"},children:M})]}),(0,l.jsxs)("p",{children:["Flex dollars:"," ",(0,l.jsx)("span",{style:{color:v.includes("Ahead")?"green":"red"},children:v})]})]}),(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Ideal Usage Per Day"}),(0,l.jsxs)("p",{children:["Meal blocks: ",b.toFixed(2)]}),(0,l.jsxs)("p",{children:["Flex dollars: $",j.toFixed(2)]}),(0,l.jsx)("h3",{className:"mt-4 font-semibold",children:"From Now On:"}),(0,l.jsxs)("p",{children:["Meal blocks: ",A.toFixed(2)]}),(0,l.jsxs)("p",{children:["Flex dollars: $",T.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Actual Usage Per Day"}),(0,l.jsxs)("p",{children:["Meal blocks: ",y.toFixed(2)]}),(0,l.jsxs)("p",{children:["Flex dollars: $",D.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow md:col-span-2"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Meal Blocks Usage"}),(0,l.jsx)(d.x1,{options:R,data:_})]}),(0,l.jsxs)("div",{className:"".concat(e?"bg-gray-800":"bg-white"," p-6 rounded-lg shadow md:col-span-2"),children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(e?"text-white":"text-gray-900"),children:"Flex Dollars Usage"}),(0,l.jsx)(d.x1,{options:R,data:E})]})]}):(0,l.jsx)("p",{children:"No meal option found. Please upload your meal plan data."})]})]})}},5151:function(e,a,t){"use strict";t.d(a,{q:function(){return n}});var l=t(9099),s=t(9291);let n=(0,l.Ue)()((0,s.tJ)((e,a)=>({darkMode:!1,mealPlans:[],currentMealOption:null,toggleDarkMode:()=>e(e=>({darkMode:!e.darkMode})),addMealPlanData:a=>e(e=>{let t=[...e.mealPlans],l=null;return a.forEach(e=>{let a=t.findIndex(a=>a.startDate===e.startDate&&a.planName===e.planName);if(-1!==a){let l=t[a];t[a]={...l,currentBalance:e.currentBalance,transactions:[...l.transactions,...e.transactions].filter((e,a,t)=>a===t.findIndex(a=>a.dateTime===e.dateTime&&a.location===e.location&&a.approvedAmount===e.approvedAmount))}}else t.push(e);e.planName.includes("Green")?l="Green":e.planName.includes("Blue")?l="Blue":e.planName.includes("Red")&&(l="Red")}),{mealPlans:t,currentMealOption:l||e.currentMealOption}}),clearAllData:()=>e({mealPlans:[],currentMealOption:null}),getCurrentMealOption:()=>a().currentMealOption}),{name:"cmu-meal-tracker-storage"}))}},function(e){e.O(0,[674,465,746,971,23,744],function(){return e(e.s=8752)}),_N_E=e.O()}]);